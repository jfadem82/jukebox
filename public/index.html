<!DOCTYPE html>
<html ng-app="jukebox">
<head>
	<title>Jukebox</title>
	<script type="text/javascript" src="https://ajax.googleapis.com/ajax/libs/angularjs/1.3.15/angular.js"></script>
	<script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/angular-ui-router/0.2.18/angular-ui-router.js"></script>
	<script type="text/javascript" src="https://cdn.rawgit.com/auth0/angular-jwt/master/dist/angular-jwt.js"></script>

	<script src="https://w.soundcloud.com/player/api.js" type="text/javascript"></script>

	<script src="js/app.js"></script>
	<script src="js/usersController.js"></script>
	<script src="js/authFactories.js"></script>
	<script src="js/router.js"></script>
	<script src="js/editFactories.js"></script>
	<script src="js/jwtController.js"></script>

<style type="text/css">
body {
margin:40px auto;
max-width:650px;
line-height:1.6;
font-size:18px;
color:#222;
background: #eee;
padding:0 10px }
h1,h2,h3 {
line-height:1.2
}
</style>
</head>
	<body ng-controller="UsersController as usersCtrl">

		<nav><h3>
			<a ui-sref="login">login</a>
			<a ui-sref="signup">signup</a>
			<a ui-sref="home">home</a>
			<a ui-sref="search">search</a>
			<a ui-sref="newplaylist">new playlist</a></h3>
		</nav>

		<div class="container">
			<div ui-view></div>
		</div>

		<iframe id="sc-widget" src="https://w.soundcloud.com/player/?url=https://api.soundcloud.com/tracks/2996795" width="25%" height="25%" scrolling="no" frameborder="no"></iframe>

		<script src="https://w.soundcloud.com/player/api.js" type="text/javascript"></script>
		<script type="text/javascript">
		  (function(){
		    var widgetIframe = document.getElementById('sc-widget'),
		        widget       = SC.Widget(widgetIframe);

		    widget.bind(SC.Widget.Events.READY, function() {
		      widget.bind(SC.Widget.Events.PLAY, function() {
		        // get information about currently playing sound
		        widget.getCurrentSound(function(currentSound) {
		          console.log('sound ' + currentSound.get('') + 'began to play');
		        });
		      });
		      // get current level of volume
		      widget.getVolume(function(volume) {
		        console.log('current volume value is ' + volume);
		      });
		      // set new volume level
		      widget.setVolume(50);
		      // get the value of the current position
					widget.getDuration(function(duration) {
						console.log("duration",duration);
						// var ourPosition = 0
						// while(ourPosition < duration)
						// widget.getPosition(function(position){
						// 	ourPosition = position
						// 	console.log("get position thing happening", position);
						// })
					})
					//////////////////// Essential Event Finish ///////////////////////
					widget.bind(SC.Widget.Events.FINISH, function(){
            var div = document.getElementById('next')
						div.setAttribute("ng-init", "usersCtrl.nextsong()")
						console.log("the finish thing is happening!!!!!!!!");
          })
					//////////////////// Essential Event Finish ///////////////////////
					var div = document.getElementById('next')
					div.setAttribute("ng-init", "usersCtrl.nextsong()")
		    });
			}());
		</script>
		<div id="next"></div>


	</body>

</html>
